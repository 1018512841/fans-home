<div id="navbar_area" class="navbar navbar-static">
  <div class="container">
    <ul class="nav pull-right" role="navigation">
      <li class="dropdown">
        <a id="drop1" href="#" role="button" class="dropdown-toggle" data-toggle="dropdown">
          <%= I18n.t "navigation_text" %>
          <b class="caret"></b></a>
        <ul class="dropdown-menu" role="menu" aria-labelledby="drop1">
          <li role="presentation"><a role="menuitem" tabindex="-1" href="#"><%= I18n.t "life_text" %></a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="#"><%= I18n.t "work_text" %></a>
          </li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="#"><%= I18n.t "tourist_text" %></a></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="#"><%= I18n.t "research_text" %></a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a href="#" id="drop2" role="button" class="dropdown-toggle" data-toggle="dropdown"><%= get_current_user_name %>
          <b class="caret"></b></a>
        <ul class="dropdown-menu" role="menu" aria-labelledby="drop2">
          <% if current_is_login? %>
              <li role="presentation"><a role="menuitem" tabindex="-1" href="<%= edit_user_url(get_current_user) %>"><%= I18n.t "setting" %></a></li>
              <li role="presentation"><a role="menuitem" tabindex="-1" href="<%= users_logout_url %>"><%= I18n.t "sign_out" %></a>
              </li>
          <% else %>
              <li role="presentation"><a role="menuitem" tabindex="-1" href="<%= login_url %>"><%= I18n.t "visitor_login" %></a></li>
              <li role="presentation"><a role="menuitem" tabindex="-1" href="<%= new_user_url %>"><%= I18n.t "visitor_signin" %></a></li>
          <% end %>
        </ul>
      </li>
      <li>
        <%= select_tag "i18n_locale", options_for_select(
                {"English" => "en", "中文" => "zh"}, session[:default_locale]) %>
      </li>
    </ul>
  </div>
</div>

<script>
    $(Document).ready(function () {
        $("#i18n_locale").change(function () {
            var params = {
                locale: $(this).val(),
                back_url: window.location.href
            };
            var options = {
                url: "/sessions/change_locale",
                type: "POST",
                data: params,
                success: function () {
                    location.reload()
                }

            };
            $.ajax(options);
        })

    })
</script>